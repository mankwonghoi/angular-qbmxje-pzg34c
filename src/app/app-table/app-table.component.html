<!--Nav Bar-->
<ul ngbNav [(activeId)]="activeId" class="nav-pills">
  <li [ngbNavItem]="1" (click)="onTabChange()">
    <a ngbNavLink>User</a>
  </li>
  <li [ngbNavItem]="2" (click)="onTabChange()">
    <a ngbNavLink>User Access</a>
  </li>
  <li [ngbNavItem]="3" (click)="onTabChange()">
    <a ngbNavLink>Group</a>
  </li>
</ul>

<button class="btn" (click)="changeMode()">
  {{ isEditMode ? 'Change To View Mode' : 'Change To Edit Mode' }}
</button>

<button
  *ngIf="isEditMode"
  class="submit"
  (click)="save()"
  [disabled]="saveBtnDisabled()"
>
  Save
</button>

<!--Table-->
<table class="table table-striped">
  <thead>
    <!--Header-->
    <tr *ngIf="_columnDefinition">
      <th *ngIf="isEditMode"><button (click)="addRecord()">Add</button></th>
      <th *ngFor="let column of _columnDefinition">
        <div *ngIf="!isEditMode">
          <!--Show Input box if it can be filter-->
          <div *ngIf="column.filterable">
            <input
              type="text"
              placeholder="{{ column.columnHeader }}"
              (input)="inputChange($event, column)"
              name="{{ column.columnId }}"
              [(ngModel)]="column.ngValue"
              value="{{ column.ngValue }}"
            />
          </div>
          <!--Show Label if it can't be filter-->
          <div *ngIf="!column.filterable">
            {{ column.columnHeader }}
          </div>
        </div>

        <div *ngIf="isEditMode">
          {{ column.columnHeader }}
        </div>
      </th>
    </tr>
  </thead>
  <!--Body-->
  <tbody *ngIf="!isEditMode && _viewSelected == 1">
    <!--User-->
    <tr *ngFor="let item of _tableViewData">
      <td>{{ item.userId }}</td>
      <td>{{ item.firstName }}</td>
      <td>{{ item.lastName }}</td>
      <td>{{ item.loginName }}</td>
      <td>{{ item.password | maskPassword }}</td>
      <td>{{ item.email }}</td>
    </tr>
  </tbody>
  <tbody *ngIf="!isEditMode && _viewSelected == 2">
    <!--User Access-->
    <tr *ngFor="let item of _tableViewData">
      <td>{{ item.userId }}</td>
      <td>{{ item.groupId }}</td>
      <td>{{ item.dateOfRelationshipCreation }}</td>
    </tr>
  </tbody>
  <tbody *ngIf="!isEditMode && _viewSelected == 3">
    <!--Group-->
    <tr *ngFor="let item of _tableViewData">
      <td>{{ item.groupId }}</td>
      <td>{{ item.groupName }}</td>
      <td>{{ item.description }}</td>
    </tr>
  </tbody>
  <tbody *ngIf="isEditMode && _viewSelected == 1">
    <!--User-->
    <tr *ngFor="let editItem of _tableViewData">
      <td><button (click)="deleteRecord(editItem)">delete</button></td>
      <td>
        <input
          *ngIf="editItem.newRecord"
          type="text"
          value="{{ editItem.userId }}"
          [(ngModel)]="editItem.userId"
          (focusout)="onInputIdleave(editItem.userId)"
        />
        <span *ngIf="!editItem.newRecord">{{ editItem.userId }}</span>
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.firstName }}"
          [(ngModel)]="editItem.firstName"
        />
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.lastName }}"
          [(ngModel)]="editItem.lastName"
        />
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.loginName }}"
          [(ngModel)]="editItem.loginName"
        />
      </td>
      <td>
        <input
          type="password"
          value="{{ editItem.password }}"
          [(ngModel)]="editItem.password"
        />
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.email }}"
          [(ngModel)]="editItem.email"
        />
      </td>
    </tr>
  </tbody>
  <tbody *ngIf="isEditMode && _viewSelected == 2">
    <!--User Access-->
    <tr *ngFor="let editItem of _tableViewData">
      <td><button (click)="deleteRecord(editItem)">delete</button></td>
      <td>
        <input
          *ngIf="editItem.newRecord"
          type="dropdown"
          value="{{ editItem.userId }}"
          [(ngModel)]="editItem.userId"
          (focusout)="onInputIdleave(editItem.userId)"
        />
        <span *ngIf="!editItem.newRecord">{{ editItem.userId }}</span>
      </td>
      <td>
        <input
          type="dropDown"
          value="{{ editItem.groupId }}"
          [(ngModel)]="editItem.groupId"
        />
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.dateOfRelationshipCreation }}"
          [(ngModel)]="editItem.dateOfRelationshipCreation"
        />
      </td>
    </tr>
  </tbody>
  <tbody *ngIf="isEditMode && _viewSelected == 3">
    <!--Group-->
    <tr *ngFor="let editItem of _tableViewData">
      <td><button (click)="deleteRecord(editItem)">delete</button></td>
      <td>
        <input
          *ngIf="editItem.newRecord"
          type="text"
          value="{{ editItem.groupId }}"
          [(ngModel)]="editItem.groupId"
          (focusout)="onInputIdleave(editItem.groupId)"
        />
        <span *ngIf="!editItem.newRecord">{{ editItem.userId }}</span>
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.groupName }}"
          [(ngModel)]="editItem.groupName"
        />
      </td>
      <td>
        <input
          type="text"
          value="{{ editItem.description }}"
          [(ngModel)]="editItem.description"
        />
      </td>
    </tr>
  </tbody>
</table>

<!--Dialog-->
<app-dialog></app-dialog>
